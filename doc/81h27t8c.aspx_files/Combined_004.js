MTPS=window.MTPS||{},MTPS.NetReflector=window.MTPS.NetReflector||{},MTPS.NetReflector.Init=function(){$&&function($){$.Microsoft||($.Microsoft={}),$.Microsoft.Mtps||($.Microsoft.Mtps={}),$.Microsoft.Mtps.NetReflector=function(options){return this.init(options)},$.extend($.Microsoft.Mtps.NetReflector.prototype,{init:function(options){this.surveyUrl=options.surveyUrl,this.privacyStatementText=options.privacyStatementText,this.trackerWindowText=options.trackerWindowText,this.privacyStatementLink=options.privacyStatementLink,this.trackerHeaderClass=options.trackerHeaderClass,this.nrMainPanel=$(".NetReflectorMain"),this.nrCloseButton=$(".NRCloseButton"),this.nrSubmitButton=$(".NRSubmit"),this.nrCancelButton=$(".NRCancel"),navigator.cookieEnabled&&(this.bindEvent(),this.setNRCookie(),this.showPopup())},bindEvent:function(){this.nrCloseButton.bind("click",this,function(e){e.data.nrMainPanel.css("display","none")}),this.nrSubmitButton.bind("click",this,function(e){e.data.popupTracker(),e.data.nrMainPanel.css("display","none")}),this.nrCancelButton.bind("click",this,function(e){e.data.nrMainPanel.css("display","none")})},showPopup:function(){var top=($(window).height()-this.nrMainPanel.height())/2,left=($(window).width()-this.nrMainPanel.width())/2;this.nrMainPanel.css("top",top>0?top:0),this.nrMainPanel.css("left",left>0?left:0),this.nrMainPanel.css("display","block"),this.addAnimation(),this.nrSubmitButton.focus()},setNRCookie:function(){window.epx&&window.epx.utilities?window.epx.utilities.setCookie("netreflector","1",90,"/",".microsoft.com",null):MTPS.Utility.SetCookie("netreflector","1",90,"/",".microsoft.com",null)},addAnimation:function(){var nrMainPanel=this.nrMainPanel;$(window).resize(function(e){nrMainPanel.animate({top:($(window).height()-nrMainPanel.height())/2,left:($(window).width()-nrMainPanel.width())/2},500)})},popupTracker:function(){newwindow=window.open("","","height=320px,width=385px,scrollbars=1"),newdocument=newwindow.document,newdocument.write(this.getTrackerHtml()),newdocument.close()},getTrackerHtml:function(){var trackerHtml="<html>";return trackerHtml+="<head>",trackerHtml+="<title>Survey Tracker<\/title>",trackerHtml+='<link href="/Areas/Epx/Content/Css/NetReflector.css" rel="stylesheet" type="text/css" />',trackerHtml+="<\/head>",trackerHtml+='<body class="NRTrackerBody">',trackerHtml+='<div class="NRTrackerMain">',trackerHtml+='<div class="'+this.trackerHeaderClass+'"><\/div>',trackerHtml+='<div class="NRTopStripe"><\/div>',trackerHtml+='<div class="NRNotification">',trackerHtml+="<div>"+this.trackerWindowText+"<\/div>",trackerHtml+='<div class="PrivacyStatement"><a href="'+this.privacyStatementLink+'" target="_blank">'+this.privacyStatementText+"<\/a><\/div><\/div>",trackerHtml+='<div class="NRBottomStripe" />',trackerHtml+="<\/div>",trackerHtml+="<\/body>",trackerHtml+="<\/html>",trackerHtml+='<script type="text/javascript">',trackerHtml+='var timer = self.setInterval("checkParentWindow()", 1000);',trackerHtml+="var mainWindow;",trackerHtml+="function checkParentWindow() {",trackerHtml+="if (window.opener) {",trackerHtml+="if (window.opener.closed) { showSurvey(); }",trackerHtml+="else { try { mainWindow = window.opener.location.href; } catch (ex) { showSurvey(); } } }",trackerHtml+="else { showSurvey(); } }",trackerHtml+="function showSurvey() {",trackerHtml+="timer = window.clearInterval(timer);",trackerHtml+="window.focus();",trackerHtml+="window.resizeTo(740, 800);",trackerHtml+='window.location = "'+this.surveyUrl+'";',trackerHtml+="timer = window.clearInterval(timer); }",trackerHtml+="<\/script>"}}),$(document).ready(function(){var netReflectorInit=MTPS.NetReflectorInit;new $.Microsoft.Mtps.NetReflector({surveyUrl:netReflectorInit.surveyUrl,privacyStatementText:netReflectorInit.privacyStatementText,trackerWindowText:netReflectorInit.trackerWindowText,privacyStatementLink:netReflectorInit.privacyStatementLink,trackerHeaderClass:netReflectorInit.trackerHeaderClass})})}(jQuery)},typeof jQuery=="undefined"?MTPS.Utility.loadJS("http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js",function(){MTPS.NetReflector.Init()}):$(document).ready(function(){console.log("netreflector"),MTPS.NetReflector.Init()});;
Epx=window.Epx||{},Epx.Controls=window.Epx.Controls||{},Epx.Controls.UnobtrusivePopUp=function(popUp,popUpOpener,heightOffSet,leftOffSet,forceHide){var style=$(popUp).attr("style"),hideStyle="display: none",hideStyleSemiColon="display: none;",position,containerHeight;style=="undefined"&&($(popUp).is(":visible")||(style=hideStyle)),forceHide?style=hideStyle:style==hideStyle||style==hideStyleSemiColon?(position=$(popUpOpener).position(),containerHeight=$(popUp).height(),style="top:"+(position.top-containerHeight-heightOffSet)+"px; left:"+(position.left-leftOffSet)+"px;"):style=hideStyle,$(popUp).attr("style",style),$(popUpOpener+", "+popUp).click(function(event){event.stopPropagation()})},$(document).ready(function(){var opener="#SiteFeedbackLinkOpener",popup="#SiteFeedbackLinkContainer",closer="#SiteFeedbackLinkCloser";$(opener+", "+closer).click(function(){Epx.Controls.UnobtrusivePopUp(popup,opener,-230,0,!1)})});;
function WatermarkFocus(control,defaultValue,cssValue){control.value==defaultValue&&(control.value="",control.className=cssValue),document.onkeydown=""}function WatermarkBlur(control,defaultValue,cssValue){control.value==""&&(control.value=defaultValue,control.className=cssValue),typeof Presskey!="undefined"&&Presskey&&(document.onkeydown=Presskey)}function AddWatermark(controlName,defaultValue,cssValue){document.getElementById(controlName).value==""&&(document.getElementById(controlName).value=defaultValue,document.getElementById(controlName).className=cssValue)}function WatermarkOnSubmit(control,defaultValue,cssValue){control.value==defaultValue&&(control.value="",control.className=cssValue)}function TextBoxCharactersCounter(control,counter,max){control.value.length>max?control.value=control.value.substring(0,max):counter.innerHTML=(max-control.value.length).toString()}function SiteFeedbackNewWindow(url){window.open(url,"_blank","width=750,height=836,toolbar=no,menubar=no,scrollbars=no,resizable=no,location=no,directories=no,status=no")}function SearchBoxOnSubmit(textValue){return document.getElementById("HeaderSearchTextBox").value!=textValue&&document.getElementById("HeaderSearchTextBox").value!=""?(document.getElementById("HeaderSearchForm").submit(),!0):!1}epx=window.epx||{},epx.topicModule=function(w){function setPrintExperience(){var device=$("#MtpsDevice").val(),isPrint,$printCss;device&&(isPrint=device.toLowerCase()==="printer",$printCss=$('<link type="text/css" rel="stylesheet" href="/Areas/Epx/Content/Css/PrintView.css" />'),isPrint!==!0&&$printCss.attr("media","print"),$("head").append($printCss),isPrint===!0&&w.print&&w.print())}return{setPrintExperience:setPrintExperience}},epx.topic=epx.topicModule(window),$(document).ready(function(){epx.topic.setPrintExperience()});;
epx=window.epx||{},epx.codeSnippetModule=function(w,d){function init(){scrollOnLoad(),initCopyLinks()}function initCopyLinks(){w.clipboardData&&$("a[name=CodeSnippetCopyLink]").css("display","block")}function copyCode(id){if(w.clipboardData){var obj=d.getElementById(id);w.clipboardData.setData("Text",obj.innerText)}}function scrollOnLoad(){var hash=location.hash,hashY;hash.length>1&&hash.substr(1,1)==="Y"&&(hashY=Number(hash.substr(2)),isNaN(hashY)||w.scrollTo(0,hashY))}return{init:init,initCopyLinks:initCopyLinks,copyCode:copyCode,scrollOnLoad:scrollOnLoad}},epx.codeSnippet=epx.codeSnippetModule(window,document),$(document).ready(function(){epx.codeSnippet.init()});;
function TopicNotInScope_ShowPicker(){var topicNotInScopePicker=document.getElementById("topicNotInScopeCollectionPicker");topicNotInScopePicker&&(topicNotInScopePicker.style.display=topicNotInScopePicker.style.display!="block"?"block":"none")}function TopicNotInScope_HidePicker(e){var topicNotInScopePicker=document.getElementById("topicNotInScopeCollectionPicker"),src,e;topicNotInScopePicker&&(e=e||window.event,e.target?src=e.target:e.srcElement&&(src=e.srcElement),src.tagName=="A"&&src.parentNode.parentNode&&src.parentNode.parentNode.id=="topicNotInScopeCollectionPicker"||src.id=="topicNotInScopeSwitchCollection"||src.id=="topicNotInScopeDropdownImage"||src.id=="topicNotInScopeSwitchCollectionContainer"||topicNotInScopePicker.style.display!="block"||(topicNotInScopePicker.style.display="none"))}document.addEventListener?document.addEventListener("mouseup",TopicNotInScope_HidePicker,!1):document.attachEvent&&document.attachEvent("onmouseup",TopicNotInScope_HidePicker);;
(typeof(window.MTPS==="undefined")||typeof(window.MTPS.CollapsibleAreas==="undefined"))&&$("a.LW_CollapsibleArea_TitleAhref").live("click",function(){var $this=$(this),$image=$this.children("span").first(),$content=$this.parent().parent().next(),stringsAvailable;$image&&$content&&($this.removeAttr("title"),stringsAvailable=typeof window.MTPS!="undefined"&&typeof window.MTPS.LocalizedStrings!="undefined",$content.attr("class")==="sectionblock"?($image.attr("class","cl_CollapsibleArea_collapsing LW_CollapsibleArea_Img"),$content.attr("class","sectionnone"),stringsAvailable===!0&&$this.attr("title",window.MTPS.LocalizedStrings.ExpandButtonTooltip)):($image.attr("class","cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"),$content.attr("class","sectionblock"),stringsAvailable===!0&&$this.attr("title",window.MTPS.LocalizedStrings.CollapseButtonTooltip)))});;
epx=window.epx||{},epx.versionSelector=function(){function init(){$link&&$arrow&&$list&&($link.live("click",function(){epx.versionSelector.open()}),$arrow.live("click",function(){epx.versionSelector.open()}),$(document).live("mouseup",function(){epx.versionSelector.close()}))}function open(){$list.show()}function close(){$list.hide()}var $link=$("#vsLink"),$arrow=$("#vsArrow"),$list=$("#vsPanel");return{init:init,open:open,close:close}}(),$(document).ready(function(){epx.versionSelector.init()});;
var isMetroIE10=navigator.userAgent.indexOf("MSIE 10.0")!=-1&&window.innerWidth==screen.width&&window.innerHeight==screen.height,brokerScript;isMetroIE10||(brokerScript=document.createElement("script"),brokerScript.src="//js.microsoft.com/library/svy/sto/broker.js",document.getElementsByTagName("head")[0].appendChild(brokerScript));;
