<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Asynchronous Queues</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.68.1">
<link rel="start" href="index.html" title="GLib Reference Manual">
<link rel="up" href="glib-core.html" title="GLib Core Application Support">
<link rel="prev" href="glib-Thread-Pools.html" title="Thread Pools">
<link rel="next" href="glib-Dynamic-Loading-of-Modules.html" title="Dynamic Loading of Modules">
<meta name="generator" content="GTK-Doc V1.7 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
<link rel="chapter" href="glib.html" title="GLib Overview">
<link rel="chapter" href="glib-fundamentals.html" title="GLib Fundamentals">
<link rel="chapter" href="glib-core.html" title="GLib Core Application Support">
<link rel="chapter" href="glib-utilities.html" title="GLib Utilities">
<link rel="chapter" href="glib-data-types.html" title="GLib Data Types">
<link rel="chapter" href="tools.html" title="GLib Tools">
<link rel="index" href="ix01.html" title="Index">
<link rel="index" href="ix02.html" title="Index of deprecated symbols">
<link rel="index" href="ix03.html" title="Index of new symbols in 2.2">
<link rel="index" href="ix04.html" title="Index of new symbols in 2.4">
<link rel="index" href="ix05.html" title="Index of new symbols in 2.6">
<link rel="index" href="ix06.html" title="Index of new symbols in 2.8">
<link rel="index" href="ix07.html" title="Index of new symbols in 2.10">
<link rel="index" href="ix08.html" title="Index of new symbols in 2.12">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2">
<tr valign="middle">
<td><a accesskey="p" href="glib-Thread-Pools.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td>
<td><a accesskey="u" href="glib-core.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td>
<th width="100%" align="center">Справочное описание GLib</th>
<td><a accesskey="n" href="glib-Dynamic-Loading-of-Modules.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></a></td>
</tr>
<tr><td colspan="5" class="shortcuts"><nobr><a href="#id2612304" class="shortcut">Начало</a>
                  &#160;|&#160;
                  <a href="#id2612902" class="shortcut">Описание</a></nobr></td></tr>
</table>
<div class="refentry" lang="en">
<a name="glib-Asynchronous-Queues"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2>
<a name="id2612304"></a><span class="refentrytitle">Asynchronous Queues</span>
</h2>
<p>Asynchronous Queues &#8212; Асинхронное взаимодействие между потоками.</p>
</td>
<td valign="top" align="right"></td>
</tr></table></div>
<div class="refsynopsisdiv">
<h2>Краткое описание</h2>
<pre class="synopsis">

#include &lt;glib.h&gt;


            <a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a>;
<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a>* <a href="glib-Asynchronous-Queues.html#g-async-queue-new">g_async_queue_new</a>              (void);
<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a>* <a href="glib-Asynchronous-Queues.html#g-async-queue-ref">g_async_queue_ref</a>              (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-unref">g_async_queue_unref</a>             (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-push">g_async_queue_push</a>              (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> data);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-push-sorted">g_async_queue_push_sorted</a>       (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> data,
                                             <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc">GCompareDataFunc</a> func,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> user_data);
<a href="glib-Basic-Types.html#gpointer">gpointer</a>    <a href="glib-Asynchronous-Queues.html#g-async-queue-pop">g_async_queue_pop</a>               (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
<a href="glib-Basic-Types.html#gpointer">gpointer</a>    <a href="glib-Asynchronous-Queues.html#g-async-queue-try-pop">g_async_queue_try_pop</a>           (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
<a href="glib-Basic-Types.html#gpointer">gpointer</a>    <a href="glib-Asynchronous-Queues.html#g-async-queue-timed-pop">g_async_queue_timed_pop</a>         (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Date-and-Time-Functions.html#GTimeVal">GTimeVal</a> *end_time);
<a href="glib-Basic-Types.html#gint">gint</a>        <a href="glib-Asynchronous-Queues.html#g-async-queue-length">g_async_queue_length</a>            (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-sort">g_async_queue_sort</a>              (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc">GCompareDataFunc</a> func,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> user_data);

void        <a href="glib-Asynchronous-Queues.html#g-async-queue-lock">g_async_queue_lock</a>              (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-unlock">g_async_queue_unlock</a>            (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-ref-unlocked">g_async_queue_ref_unlocked</a>      (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-unref-and-unlock">g_async_queue_unref_and_unlock</a>  (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-push-unlocked">g_async_queue_push_unlocked</a>     (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> data);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-push-sorted-unlocked">g_async_queue_push_sorted_unlocked</a>
                                            (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> data,
                                             <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc">GCompareDataFunc</a> func,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> user_data);
<a href="glib-Basic-Types.html#gpointer">gpointer</a>    <a href="glib-Asynchronous-Queues.html#g-async-queue-pop-unlocked">g_async_queue_pop_unlocked</a>      (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
<a href="glib-Basic-Types.html#gpointer">gpointer</a>    <a href="glib-Asynchronous-Queues.html#g-async-queue-try-pop-unlocked">g_async_queue_try_pop_unlocked</a>  (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
<a href="glib-Basic-Types.html#gpointer">gpointer</a>    <a href="glib-Asynchronous-Queues.html#g-async-queue-timed-pop-unlocked">g_async_queue_timed_pop_unlocked</a>
                                            (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Date-and-Time-Functions.html#GTimeVal">GTimeVal</a> *end_time);
<a href="glib-Basic-Types.html#gint">gint</a>        <a href="glib-Asynchronous-Queues.html#g-async-queue-length-unlocked">g_async_queue_length_unlocked</a>   (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);
void        <a href="glib-Asynchronous-Queues.html#g-async-queue-sort-unlocked">g_async_queue_sort_unlocked</a>     (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc">GCompareDataFunc</a> func,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> user_data);
</pre>
</div>
<div class="refsect1" lang="en">
<a name="id2612902"></a><h2>Описание</h2>
<p>
Часто вам нужна взаимосвязь между разными потоками. В общем более
безопасно делать это не с помощью общей памяти, а явно передавать
сообщения. Эти сообщения имеют смысл только если они асинхронны 
для много-поточных приложений, однако, синхронные операции могут
также выполняться в тех же потоках.
</p>
<p>
Асинхронные структуры данных являются исключением из большинства других
структур данных GLib, поскольку они могут использоваться одновременно
в множестве потоков без явной блокировки и они имеют свой собственный 
встроенный подсчет ссылок. Так как асинхронные структуры данных будут
всегда использоваться как минимум двумя параллельными потоками.
</p>
<p>
Для использования асинхронной структуры сначала нужно её создать с помощью
<a href="glib-Asynchronous-Queues.html#g-async-queue-new"><code class="function">g_async_queue_new()</code></a>. Вновь созданная структура имеет количество ссылок равное 1. 
Каждый раз, когда другой поток создаёт новую ссылку на (то есть указатель на) 
структуру, количество её ссылок увеличивается (используется <a href="glib-Asynchronous-Queues.html#g-async-queue-ref"><code class="function">g_async_queue_ref()</code></a>). 
Также, перед удаление этой ссылки, количество ссылок уменьшается (используется
<a href="glib-Asynchronous-Queues.html#g-async-queue-unref"><code class="function">g_async_queue_unref()</code></a>). После этого структура не может больше существовать,
поэтому вы не должны обращаться к ней.
</p>
<p>
Поток который хочет отправить сообщение в эту структуру просто вызывает
<a href="glib-Asynchronous-Queues.html#g-async-queue-push"><code class="function">g_async_queue_push()</code></a> для помещения сообщения в очередь.
</p>
<p>
Поток который ожидает сообщение из асинхронной структуры просто вызывает
<a href="glib-Asynchronous-Queues.html#g-async-queue-pop"><code class="function">g_async_queue_pop()</code></a> для этой очереди. Если нет доступных сообщений в 
указанной очереди, поток засыпает пока не появится сообщение. Сообщение 
удаляется из очереди и возвращается. Функции <a href="glib-Asynchronous-Queues.html#g-async-queue-try-pop"><code class="function">g_async_queue_try_pop()</code></a> и
<a href="glib-Asynchronous-Queues.html#g-async-queue-timed-pop"><code class="function">g_async_queue_timed_pop()</code></a> могут использоваться только для проверки присутствия
сообщений или ожидания определенное время сообщений соответственно.
</p>
<p>
Почти для каждой функции существует два варианта, первый блокирует 
очередь, а второй не делает этого. Таким образом вы можете удерживать 
блокировку очереди (блокировать с помощью  href="glib-Asynchronous-Queues.html#g-async-queue-lock"><code class="function">g_async_queue_lock()</code></a> и 
освобождать с помощью <a href="glib-Asynchronous-Queues.html#g-async-queue-unlock"><code class="function">g_async_queue_unlock()</code></a>) через множественные 
инструкции доступа к очереди. Это может быть необходимо для гарантирования
целостности очереди, но должно использоваться только когда это действительно 
необходимо, так как может усложнить вам жизнь при неблагоразумном использовании. 
Обычно вы должны использовать только варианты функции блокировки 
(то есть без суффикса _unlocked)
</p>
</div>
<div class="refsect1" lang="en">
<a name="id2613064"></a><h2>Детали</h2>
<div class="refsect2" lang="en">
<a name="id2613074"></a><h3>
<a name="GAsyncQueue"></a>GAsyncQueue</h3>
<a class="indexterm" name="id2613086"></a><pre class="programlisting">typedef struct _GAsyncQueue GAsyncQueue;</pre>
<p>
Структура <a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a> - это закрытая структура данных, которые представляют асинхронную очередь. 
Доступ к этим данным должен осуществляться только с помощью функций <code class="function">g_async_queue_*</code>.
</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2613118"></a><h3>
<a name="g-async-queue-new"></a>g_async_queue_new ()</h3>
<a class="indexterm" name="id2613131"></a><pre class="programlisting"><a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a>* g_async_queue_new              (void);</pre>
<p>
Создаёт новую асинхронную структуру с начальным количеством ссылок равным 1.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> новая <a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2613177"></a><h3>
<a name="g-async-queue-ref"></a>g_async_queue_ref ()</h3>
<a class="indexterm" name="id2613190"></a><pre class="programlisting"><a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a>* g_async_queue_ref              (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Увеличивает количество ссылок асинхронной <em class="parameter"><code>queue</code></em> на 1. 
Вы не должны удерживать блокировку для вызова этой функции.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> <em class="parameter"><code>queue</code></em> которую помещали (Начиная с версии 2.6)
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2613269"></a><h3>
<a name="g-async-queue-unref"></a>g_async_queue_unref ()</h3>
<a class="indexterm" name="id2613282"></a><pre class="programlisting">void        g_async_queue_unref             (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Уменьшает количество ссылок асинхронной <em class="parameter"><code>queue</code></em> на 1. Если количество ссылок дошло до 0, 
<em class="parameter"><code>queue</code></em> уничтожается и память распределённая для неё освобождается. 
Таким образом вам нельзя использовать <em class="parameter"><code>queue</code></em> впоследствии. Вам не нужно удерживать блокировку 
для вызова этой функции.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2613359"></a><h3>
<a name="g-async-queue-push"></a>g_async_queue_push ()</h3>
<a class="indexterm" name="id2613373"></a><pre class="programlisting">void        g_async_queue_push              (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> data);</pre>
<p>
Помещает  <em class="parameter"><code>data</code></em> в <em class="parameter"><code>queue</code></em>. <em class="parameter"><code>data</code></em> должен быть не <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>data</code></em>&#160;:</span></td>
<td> <em class="parameter"><code>data</code></em> помещаемые в <em class="parameter"><code>queue</code></em>.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2613488"></a><h3>
<a name="g-async-queue-push-sorted"></a>g_async_queue_push_sorted ()</h3>
<a class="indexterm" name="id2613504"></a><pre class="programlisting">void        g_async_queue_push_sorted       (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> data,
                                             <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc">GCompareDataFunc</a> func,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> user_data);</pre>
<p>
Вставляет <em class="parameter"><code>data</code></em> в <em class="parameter"><code>queue</code></em> используя <em class="parameter"><code>func</code></em> для определения новой позиции. 
</p>
<p>
Перед использованием функции для вставки нового элемента,  <em class="parameter"><code>queue</code></em> должна быть отсортирована.
</p>
<p>
Эта функция блокирует <em class="parameter"><code>queue</code></em> перед сортировкой и разблокирует после завершения работы.
</p>
<p>
Для примера <em class="parameter"><code>func</code></em> смотрите <a href="glib-Asynchronous-Queues.html#g-async-queue-sort"><code class="function">g_async_queue_sort()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>data</code></em>&#160;:</span></td>
<td> <em class="parameter"><code>data</code></em> помещаемые в <em class="parameter"><code>queue</code></em>
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>func</code></em>&#160;:</span></td>
<td>  <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc"><span class="type">GCompareDataFunc</span></a> используемая для сортировки <em class="parameter"><code>queue</code></em>. Помещая в эту функцию два элемента
  <em class="parameter"><code>queue</code></em>, функция возвращает 0 если они эквивалентны, отрицательное если первый элемент 
  должен быть выше в  <em class="parameter"><code>queue</code></em> или положительное значение, если первый элемент должен быть ниже в 
  <em class="parameter"><code>queue</code></em> чем второй элемент.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>user_data</code></em>&#160;:</span></td>
<td> пользовательские данные помещаемые в <em class="parameter"><code>func</code></em>.
</td>
</tr>
</tbody>
</table></div>
<p>Начиная с версии 2.10
</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2613745"></a><h3>
<a name="g-async-queue-pop"></a>g_async_queue_pop ()</h3>
<a class="indexterm" name="id2613758"></a><pre class="programlisting"><a href="glib-Basic-Types.html#gpointer">gpointer</a>    g_async_queue_pop               (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Выталкивает данные из <em class="parameter"><code>queue</code></em>. Эта функция блокируется пока данные доступны.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> данные из очереди.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2613830"></a><h3>
<a name="g-async-queue-try-pop"></a>g_async_queue_try_pop ()</h3>
<a class="indexterm" name="id2613844"></a><pre class="programlisting"><a href="glib-Basic-Types.html#gpointer">gpointer</a>    g_async_queue_try_pop           (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Пытается вытолкнуть данные из очереди <em class="parameter"><code>queue</code></em>. Если данные не доступны, возвращает <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> данные из очереди или <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>, если нет немедленно доступных данных.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2613937"></a><h3>
<a name="g-async-queue-timed-pop"></a>g_async_queue_timed_pop ()</h3>
<a class="indexterm" name="id2613950"></a><pre class="programlisting"><a href="glib-Basic-Types.html#gpointer">gpointer</a>    g_async_queue_timed_pop         (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Date-and-Time-Functions.html#GTimeVal">GTimeVal</a> *end_time);</pre>
<p>
Выталкивает данные из очереди <em class="parameter"><code>queue</code></em>. Если данные получены перед <em class="parameter"><code>end_time</code></em>, возвращает <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>.
</p>
<p>
Для простоты расчёта параметра <em class="parameter"><code>end_time</code></em> можно использовать комбинацию <a href="glib-Date-and-Time-Functions.html#g-get-current-time"><code class="function">g_get_current_time()</code></a>
и <a href="glib-Date-and-Time-Functions.html#g-time-val-add"><code class="function">g_time_val_add()</code></a>.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>end_time</code></em>&#160;:</span></td>
<td><a href="glib-Date-and-Time-Functions.html#GTimeVal"><span class="type">GTimeVal</span></a>, определяющая время завершения.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> данные из очереди или <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>, если данные получены раньше <em class="parameter"><code>end_time</code></em>.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2614116"></a><h3>
<a name="g-async-queue-length"></a>g_async_queue_length ()</h3>
<a class="indexterm" name="id2614130"></a><pre class="programlisting"><a href="glib-Basic-Types.html#gint">gint</a>        g_async_queue_length            (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Возвращает длину очереди, отрицательное значение означает ожидание
потоков, положительное значение означает доступность ввода в
<em class="parameter"><code>queue</code></em>. Фактически эта функция возвращает количество элементов данных
в очереди минус количество ожидающих потоков. Таким образом возвращаемое 
значение 0 может означать 'n' входов в очередь и 'n' потоков ожидания.
Это может произойти или из-за блокировки очереди или из-за планирования.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> длина <em class="parameter"><code>queue</code></em>.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2614213"></a><h3>
<a name="g-async-queue-sort"></a>g_async_queue_sort ()</h3>
<a class="indexterm" name="id2614229"></a><pre class="programlisting">void        g_async_queue_sort              (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc">GCompareDataFunc</a> func,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> user_data);</pre>
<p>
Сортирует <em class="parameter"><code>queue</code></em> используя <em class="parameter"><code>func</code></em>. 
</p>
<p>
Эта функция блокирует <em class="parameter"><code>queue</code></em> перед сортировкой и разблокирует после завершения.
</p>
<p>
Если вам нужно отсортировать список по приоритету, чтобы убедиться что низший приоритет 
будет сверху очереди, вы должны использовать:
</p>
<div class="informalexample"><pre class="programlisting"> 
 gint32 id1;
 gint32 id2;
  
 id1 = GPOINTER_TO_INT (element1);
 id2 = GPOINTER_TO_INT (element2);
  
 return (id1 &gt; id2 ? +1 : id1 == id2 ? 0 : -1);
</pre></div>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>func</code></em>&#160;:</span></td>
<td>  <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc"><span class="type">GCompareDataFunc</span></a> используемая для сортировки <em class="parameter"><code>queue</code></em>. Помещая в эту функцию два элемента
  <em class="parameter"><code>queue</code></em>, функция возвращает 0 если они эквивалентны, отрицательное если первый элемент 
  должен быть выше в  <em class="parameter"><code>queue</code></em> или положительное значение, если первый элемент должен быть ниже в 
  <em class="parameter"><code>queue</code></em> чем второй элемент.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>user_data</code></em>&#160;:</span></td>
<td> пользовательские данные помещаемые в <em class="parameter"><code>func</code></em>
</td>
</tr>
</tbody>
</table></div>
<p>Начиная с версии 2.10
</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2614414"></a><h3>
<a name="g-async-queue-lock"></a>g_async_queue_lock ()</h3>
<a class="indexterm" name="id2614427"></a><pre class="programlisting">void        g_async_queue_lock              (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Блокирует <em class="parameter"><code>queue</code></em>'s. После этого вы можете вызвать только <code class="function">g_async_queue_*<code class="function">_unlocked()</code></code> 
вариант функции для этой <em class="parameter"><code>queue</code></em>. Иначе она зависнет (deadlock).</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2614510"></a><h3>
<a name="g-async-queue-unlock"></a>g_async_queue_unlock ()</h3>
<a class="indexterm" name="id2614523"></a><pre class="programlisting">void        g_async_queue_unlock            (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Снимает блокировку queue's.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2614579"></a><h3>
<a name="g-async-queue-ref-unlocked"></a>g_async_queue_ref_unlocked ()</h3>
<a class="indexterm" name="id2614595"></a><pre class="programlisting">void        g_async_queue_ref_unlocked      (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Внимание</h3>
<p><code class="literal">g_async_queue_ref_unlocked</code> устарела и не должна использоваться во вновь создаваемом коде.</p>
</div>
<p>
Увеличивает количество ссылок асинхронной <em class="parameter"><code>queue</code></em> на 1.
</p>
<p>
<em class="parameter"><code>Устарела</code></em>: Начиная с версии 2.8, подсчёт ссылок сделан атомарным, поэтому
<a href="glib-Asynchronous-Queues.html#g-async-queue-ref"><code class="function">g_async_queue_ref()</code></a> может использоваться независимо от блокировки <em class="parameter"><code>queue</code></em>'s.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2614696"></a><h3>
<a name="g-async-queue-unref-and-unlock"></a>g_async_queue_unref_and_unlock ()</h3>
<a class="indexterm" name="id2614712"></a><pre class="programlisting">void        g_async_queue_unref_and_unlock  (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Внимание</h3>
<p><code class="literal">g_async_queue_unref_and_unlock</code> устарела и не должна использоваться во вновь создаваемом коде.</p>
</div>
<p>
Уменьшает количество ссылок асинхронной <em class="parameter"><code>queue</code></em> на 1 и отменяет блокировку. 
Эта функция должна вызываться во время удержания блокировки <em class="parameter"><code>queue</code></em>'s. 
Если количество ссылок достигло 0,  <em class="parameter"><code>queue</code></em> будет уничтожена и память 
распределённая для неё будет освобождена.
</p>
<p>
<em class="parameter"><code>Устарела</code></em>: Начиная с версии 2.8, подсчёт ссылок выполняется атомарно, поэтому
<a href="glib-Asynchronous-Queues.html#g-async-queue-unref"><code class="function">g_async_queue_unref()</code></a> может использоваться независимо от блокировки <em class="parameter"><code>queue</code></em>'s.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2614828"></a><h3>
<a name="g-async-queue-push-unlocked"></a>g_async_queue_push_unlocked ()</h3>
<a class="indexterm" name="id2614842"></a><pre class="programlisting">void        g_async_queue_push_unlocked     (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> data);</pre>
<p>
Помещает <em class="parameter"><code>data</code></em> в <em class="parameter"><code>queue</code></em>. <em class="parameter"><code>data</code></em> должен быть не <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>. Эта функция должна вызываться в течении 
блокировки <em class="parameter"><code>queue</code></em>'s.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>data</code></em>&#160;:</span></td>
<td> <em class="parameter"><code>данные</code></em> для помещения в <em class="parameter"><code>queue</code></em>.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2614965"></a><h3>
<a name="g-async-queue-push-sorted-unlocked"></a>g_async_queue_push_sorted_unlocked ()</h3>
<a class="indexterm" name="id2614982"></a><pre class="programlisting">void        g_async_queue_push_sorted_unlocked
                                            (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> data,
                                             <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc">GCompareDataFunc</a> func,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> user_data);</pre>
<p>
Вставляет <em class="parameter"><code>data</code></em> в <em class="parameter"><code>queue</code></em> используя <em class="parameter"><code>func</code></em> для определения новой позиции.
</p>
<p>
Перед использованием этой функции для вставки нового элемента <em class="parameter"><code>queue</code></em> должна быть отсортирована.
</p>
<p>
Эта функция вызывается в течении блокировки <em class="parameter"><code>queue</code></em>'s.
</p>
<p>
В качестве примера <em class="parameter"><code>func</code></em> смотрите <a href="glib-Asynchronous-Queues.html#g-async-queue-sort"><code class="function">g_async_queue_sort()</code></a>.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>data</code></em>&#160;:</span></td>
<td> <em class="parameter"><code>данные</code></em> для помещения в <em class="parameter"><code>queue</code></em>
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>func</code></em>&#160;:</span></td>
<td>  <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc"><span class="type">GCompareDataFunc</span></a> используемая для сортировки <em class="parameter"><code>queue</code></em>. Помещая в эту функцию два элемента
  <em class="parameter"><code>queue</code></em>, функция возвращает 0 если они эквивалентны, отрицательное если первый элемент 
  должен быть выше в  <em class="parameter"><code>queue</code></em> или положительное значение, если первый элемент должен быть ниже в 
  <em class="parameter"><code>queue</code></em> чем второй элемент.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>user_data</code></em>&#160;:</span></td>
<td> пользовательские данные помещаемые в <em class="parameter"><code>func</code></em>.
</td>
</tr>
</tbody>
</table></div>
<p>Начиная с версии 2.10
</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2615222"></a><h3>
<a name="g-async-queue-pop-unlocked"></a>g_async_queue_pop_unlocked ()</h3>
<a class="indexterm" name="id2615236"></a><pre class="programlisting"><a href="glib-Basic-Types.html#gpointer">gpointer</a>    g_async_queue_pop_unlocked      (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Выталкивает данные из <em class="parameter"><code>queue</code></em>. Функция блокируется пока данные доступны. 
Должна вызываться во время блокировки <em class="parameter"><code>queue</code></em>'s.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> данные из очереди.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2615315"></a><h3>
<a name="g-async-queue-try-pop-unlocked"></a>g_async_queue_try_pop_unlocked ()</h3>
<a class="indexterm" name="id2615328"></a><pre class="programlisting"><a href="glib-Basic-Types.html#gpointer">gpointer</a>    g_async_queue_try_pop_unlocked  (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Пытается вытолкнуть данные из <em class="parameter"><code>queue</code></em>. Если данные не доступны, возвращается <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>. 
Функция должна вызываться во время блокировки <em class="parameter"><code>queue</code></em>'s.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> данные из очереди или <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>, если нет немедленно доступных данных.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2615429"></a><h3>
<a name="g-async-queue-timed-pop-unlocked"></a>g_async_queue_timed_pop_unlocked ()</h3>
<a class="indexterm" name="id2615442"></a><pre class="programlisting"><a href="glib-Basic-Types.html#gpointer">gpointer</a>    g_async_queue_timed_pop_unlocked
                                            (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Date-and-Time-Functions.html#GTimeVal">GTimeVal</a> *end_time);</pre>
<p>
Выталкивает данные из <em class="parameter"><code>queue</code></em>. Если данные получены раньше <em class="parameter"><code>end_time</code></em>, 
возвращает <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>. Эта функция должна вызываться во время блокировки <em class="parameter"><code>queue</code></em>'s.
</p>
<p>
Для простоты расчета <em class="parameter"><code>end_time</code></em> можно использовать комбинацию <a href="glib-Date-and-Time-Functions.html#g-get-current-time"><code class="function">g_get_current_time()</code></a>
и <a href="glib-Date-and-Time-Functions.html#g-time-val-add"><code class="function">g_time_val_add()</code></a>.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>end_time</code></em>&#160;:</span></td>
<td><a href="glib-Date-and-Time-Functions.html#GTimeVal"><span class="type">GTimeVal</span></a>, определяющая время завершения.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> данные из очереди или <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>, если нет данных полученных раньше <em class="parameter"><code>end_time</code></em>.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2615616"></a><h3>
<a name="g-async-queue-length-unlocked"></a>g_async_queue_length_unlocked ()</h3>
<a class="indexterm" name="id2615629"></a><pre class="programlisting"><a href="glib-Basic-Types.html#gint">gint</a>        g_async_queue_length_unlocked   (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue);</pre>
<p>
Возвращает длину очереди, отрицательное значение означает ожидание потоков, положительное значение означает доступность ввода в queue. Фактически эта функция возвращает количество элементов данных в очереди минус количество ожидающих потоков. Таким образом возвращаемое значение 0 может означать 'n' входов в очередь и 'n' потоков ожидания. Это может произойти или из-за блокировки очереди или из-за планирования. Функция должна вызываться во время блокировки очереди.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td> длина очереди <em class="parameter"><code>queue</code></em>.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2615720"></a><h3>
<a name="g-async-queue-sort-unlocked"></a>g_async_queue_sort_unlocked ()</h3>
<a class="indexterm" name="id2615736"></a><pre class="programlisting">void        g_async_queue_sort_unlocked     (<a href="glib-Asynchronous-Queues.html#GAsyncQueue">GAsyncQueue</a> *queue,
                                             <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc">GCompareDataFunc</a> func,
                                             <a href="glib-Basic-Types.html#gpointer">gpointer</a> user_data);</pre>
<p>
Сортирует <em class="parameter"><code>queue</code></em> используя <em class="parameter"><code>func</code></em>. 
</p>
<p>
Эта функция вызывается во время блокировки <em class="parameter"><code>queue</code></em>'s.</p>
<p>

</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>queue</code></em>&#160;:</span></td>
<td><a href="glib-Asynchronous-Queues.html#GAsyncQueue"><span class="type">GAsyncQueue</span></a>
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>func</code></em>&#160;:</span></td>
<td>  <a href="glib-Doubly-Linked-Lists.html#GCompareDataFunc"><span class="type">GCompareDataFunc</span></a> используемая для сортировки <em class="parameter"><code>queue</code></em>. Помещая в эту функцию два элемента
  <em class="parameter"><code>queue</code></em>, функция возвращает 0 если они эквивалентны, отрицательное если первый элемент 
  должен быть выше в  <em class="parameter"><code>queue</code></em> или положительное значение, если первый элемент должен быть ниже в 
  <em class="parameter"><code>queue</code></em> чем второй элемент.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>user_data</code></em>&#160;:</span></td>
<td>
 пользовательские данные для <em class="parameter"><code>func</code></em>
</td>
</tr>
</tbody>
</table></div>
<p>Начиная с версии 2.10
</p>
</div>
</div>
</div>
</body>
</html>
