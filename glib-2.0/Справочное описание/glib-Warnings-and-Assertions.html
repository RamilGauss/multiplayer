<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Message Output and Debugging Functions</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.68.1">
<link rel="start" href="index.html" title="GLib Reference Manual">
<link rel="up" href="glib-core.html" title="GLib Core Application Support">
<link rel="prev" href="glib-Error-Reporting.html" title="Error Reporting">
<link rel="next" href="glib-Message-Logging.html" title="Message Logging">
<meta name="generator" content="GTK-Doc V1.7 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
<link rel="chapter" href="glib.html" title="GLib Overview">
<link rel="chapter" href="glib-fundamentals.html" title="GLib Fundamentals">
<link rel="chapter" href="glib-core.html" title="GLib Core Application Support">
<link rel="chapter" href="glib-utilities.html" title="GLib Utilities">
<link rel="chapter" href="glib-data-types.html" title="GLib Data Types">
<link rel="chapter" href="tools.html" title="GLib Tools">
<link rel="index" href="ix01.html" title="Index">
<link rel="index" href="ix02.html" title="Index of deprecated symbols">
<link rel="index" href="ix03.html" title="Index of new symbols in 2.2">
<link rel="index" href="ix04.html" title="Index of new symbols in 2.4">
<link rel="index" href="ix05.html" title="Index of new symbols in 2.6">
<link rel="index" href="ix06.html" title="Index of new symbols in 2.8">
<link rel="index" href="ix07.html" title="Index of new symbols in 2.10">
<link rel="index" href="ix08.html" title="Index of new symbols in 2.12">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2">
<tr valign="middle">
<td><a accesskey="p" href="glib-Error-Reporting.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td>
<td><a accesskey="u" href="glib-core.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td>
<th width="100%" align="center">Справочное описание GLib</th>
<td><a accesskey="n" href="glib-Message-Logging.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></a></td>
</tr>
<tr><td colspan="5" class="shortcuts"><nobr><a href="#id2654704" class="shortcut">Начало</a>
                  &#160;|&#160;
                  <a href="#id2654936" class="shortcut">Описание</a></nobr></td></tr>
</table>
<div class="refentry" lang="en">
<a name="glib-Warnings-and-Assertions"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2>
<a name="id2654704"></a><span class="refentrytitle">Вывод сообщений и функции отладки</span>
</h2>
<p>Message Output and Debugging Functions &#8212; Функции для вывода сообщений и помощь отладки приложений.</p>
</td>
<td valign="top" align="right"></td>
</tr></table></div>
<div class="refsynopsisdiv">
<h2>Краткое описание</h2>
<pre class="synopsis">

#include &lt;glib.h&gt;


void        <a href="glib-Warnings-and-Assertions.html#g-print">g_print</a>                         (const <a href="glib-Basic-Types.html#gchar">gchar</a> *format,
                                             ...);
<a href="glib-Warnings-and-Assertions.html#GPrintFunc">GPrintFunc</a>  <a href="glib-Warnings-and-Assertions.html#g-set-print-handler">g_set_print_handler</a>             (<a href="glib-Warnings-and-Assertions.html#GPrintFunc">GPrintFunc</a> func);
void        (<a href="glib-Warnings-and-Assertions.html#GPrintFunc">*GPrintFunc</a>)                   (const <a href="glib-Basic-Types.html#gchar">gchar</a> *string);

void        <a href="glib-Warnings-and-Assertions.html#g-printerr">g_printerr</a>                      (const <a href="glib-Basic-Types.html#gchar">gchar</a> *format,
                                             ...);
<a href="glib-Warnings-and-Assertions.html#GPrintFunc">GPrintFunc</a>  <a href="glib-Warnings-and-Assertions.html#g-set-printerr-handler">g_set_printerr_handler</a>          (<a href="glib-Warnings-and-Assertions.html#GPrintFunc">GPrintFunc</a> func);

#define     <a href="glib-Warnings-and-Assertions.html#g-return-if-fail">g_return_if_fail</a>                (expr)
#define     <a href="glib-Warnings-and-Assertions.html#g-return-val-if-fail">g_return_val_if_fail</a>            (expr,val)
#define     <a href="glib-Warnings-and-Assertions.html#g-return-if-reached">g_return_if_reached</a>             ()
#define     <a href="glib-Warnings-and-Assertions.html#g-return-val-if-reached">g_return_val_if_reached</a>         (val)

#define     <a href="glib-Warnings-and-Assertions.html#g-assert">g_assert</a>                        (expr)
#define     <a href="glib-Warnings-and-Assertions.html#g-assert-not-reached">g_assert_not_reached</a>            ()

void        <a href="glib-Warnings-and-Assertions.html#g-on-error-query">g_on_error_query</a>                (const <a href="glib-Basic-Types.html#gchar">gchar</a> *prg_name);
void        <a href="glib-Warnings-and-Assertions.html#g-on-error-stack-trace">g_on_error_stack_trace</a>          (const <a href="glib-Basic-Types.html#gchar">gchar</a> *prg_name);

#define     <a href="glib-Warnings-and-Assertions.html#G-BREAKPOINT:CAPS">G_BREAKPOINT</a>                    ()

</pre>
</div>
<div class="refsect1" lang="en">
<a name="id2654936"></a><h2>Описание</h2>
<p>
Эти функции обеспечивают поддержку вывода сообщений.
</p>
</div>
<div class="refsect1" lang="en">
<a name="id2654952"></a><h2>Детали</h2>
<div class="refsect2" lang="en">
<a name="id2654962"></a><h3>
<a name="g-print"></a>g_print ()</h3>
<a class="indexterm" name="id2654975"></a><pre class="programlisting">void        g_print                         (const <a href="glib-Basic-Types.html#gchar">gchar</a> *format,
                                             ...);</pre>
<p>
Вывод форматированных сообщений через обработчик печати.
По умолчанию обработчик печати просто выводит сообщения на стандартный вывод (stdout).
</p>
<p>
<a href="glib-Warnings-and-Assertions.html#g-print"><code class="function">g_print()</code></a> не должна использоваться внутри библиотеки для отладочных сообщений,
так как они могут переадресовываться приложениями в специальные окна сообщений или даже в файлы.
Вместо неё библиотека должна использовать <a href="glib-Message-Logging.html#g-log"><code class="function">g_log()</code></a>, или удобные функции
<a href="glib-Message-Logging.html#g-message"><code class="function">g_message()</code></a>, <a href="glib-Message-Logging.html#g-warning"><code class="function">g_warning()</code></a> и <a href="glib-Message-Logging.html#g-error"><code class="function">g_error()</code></a>.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>format</code></em>&#160;:</span></td>
<td>форматированное сообщение. Смотрите <code class="function"><code class="function">printf()</code></code>
документацию.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>...</code></em>&#160;:</span></td>
<td>параметры для вставки в форматированную строку.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655116"></a><h3>
<a name="g-set-print-handler"></a>g_set_print_handler ()</h3>
<a class="indexterm" name="id2655129"></a><pre class="programlisting"><a href="glib-Warnings-and-Assertions.html#GPrintFunc">GPrintFunc</a>  g_set_print_handler             (<a href="glib-Warnings-and-Assertions.html#GPrintFunc">GPrintFunc</a> func);</pre>
<p>
Устанавливает обработчик печати.
Любые сообщения помещаемые в <a href="glib-Warnings-and-Assertions.html#g-print"><code class="function">g_print()</code></a> будут выводиться через новый обработчик.
Обработчик по умолчанию просто выводит сообщения на stdout.
Обеспечивая собственный обработчик вы можете перенаправить вывод, например в виджет GTK+
или файл журнала.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>func</code></em>&#160;:</span></td>
<td>новый обработчик печати.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td>старый обработчик печати.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655200"></a><h3>
<a name="GPrintFunc"></a>GPrintFunc ()</h3>
<a class="indexterm" name="id2655213"></a><pre class="programlisting">void        (*GPrintFunc)                   (const <a href="glib-Basic-Types.html#gchar">gchar</a> *string);</pre>
<p>
Определяет тип функции обработчика печати.
Их вызывают для вывода полностью отформатированной строки на output.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>string</code></em>&#160;:</span></td>
<td>сообщение для вывода.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655261"></a><h3>
<a name="g-printerr"></a>g_printerr ()</h3>
<a class="indexterm" name="id2655274"></a><pre class="programlisting">void        g_printerr                      (const <a href="glib-Basic-Types.html#gchar">gchar</a> *format,
                                             ...);</pre>
<p>
Выводит отформатированные сообщения через обработчик сообщений об ошибках.
По умолчанию обработчик просто выводит сообщения на stderr.
</p>
<p>
<a href="glib-Warnings-and-Assertions.html#g-printerr"><code class="function">g_printerr()</code></a> не должна использоваться внутри библиотеки. Вместо неё используйте <a href="glib-Message-Logging.html#g-log"><code class="function">g_log()</code></a>, или удобные функции <a href="glib-Message-Logging.html#g-message"><code class="function">g_message()</code></a>, <a href="glib-Message-Logging.html#g-warning"><code class="function">g_warning()</code></a> и <a href="glib-Message-Logging.html#g-error"><code class="function">g_error()</code></a>.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>format</code></em>&#160;:</span></td>
<td>отформатированное сообщение. Смотрите документацию для <code class="function"><code class="function">printf()</code></code>.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>...</code></em>&#160;:</span></td>
<td>параметры для вставки в форматированную строку.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655407"></a><h3>
<a name="g-set-printerr-handler"></a>g_set_printerr_handler ()</h3>
<a class="indexterm" name="id2655420"></a><pre class="programlisting"><a href="glib-Warnings-and-Assertions.html#GPrintFunc">GPrintFunc</a>  g_set_printerr_handler          (<a href="glib-Warnings-and-Assertions.html#GPrintFunc">GPrintFunc</a> func);</pre>
<p>
Устанавливает обработчик для печати сообщений об ошибках.
Любые сообщения помещённые в <a href="glib-Warnings-and-Assertions.html#g-printerr"><code class="function">g_printerr()</code></a> будут выводиться через новый обработчик.
Обработчик по умолчанию просто выводит сообщения на stderr.
Обеспечивая собственный обработчик вы можете перенаправить вывод, например в виджет GTK+
или файл журнала.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>func</code></em>&#160;:</span></td>
<td>новый обработчик сообщений об ошибках.
</td>
</tr>
<tr>
<td><span class="term"><span class="emphasis"><em>Возвращает</em></span>&#160;:</span></td>
<td>старый обработчик сообщений об ошибках.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655492"></a><h3>
<a name="g-return-if-fail"></a>g_return_if_fail()</h3>
<a class="indexterm" name="id2655505"></a><pre class="programlisting">#define     g_return_if_fail(expr)</pre>
<p>
Завершает текущую функцию если выражение не верно.
Если выражение вычисляет <a href="glib-Standard-Macros.html#FALSE:CAPS"><code class="literal">FALSE</code></a>, регистрируется критическое сообщение и функция завершается. Может использоваться только в функциях которые не возвращают значение.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>expr</code></em>&#160;:</span></td>
<td>выражение для проверки.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655552"></a><h3>
<a name="g-return-val-if-fail"></a>g_return_val_if_fail()</h3>
<a class="indexterm" name="id2655564"></a><pre class="programlisting">#define     g_return_val_if_fail(expr,val)</pre>
<p>
Завершает текущую функцию, возвращая значение <em class="parameter"><code>val</code></em>, если выражение не верно.
Если выражение вычисляет <a href="glib-Standard-Macros.html#FALSE:CAPS"><code class="literal">FALSE</code></a>, регистрируется критическое сообщение и возвращается <em class="parameter"><code>val</code></em>.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><span class="term"><em class="parameter"><code>expr</code></em>&#160;:</span></td>
<td>выражение для проверки.
</td>
</tr>
<tr>
<td><span class="term"><em class="parameter"><code>val</code></em>&#160;:</span></td>
<td>значение возвращаемое из текущей функции если выражение не верно.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655637"></a><h3>
<a name="g-return-if-reached"></a>g_return_if_reached()</h3>
<a class="indexterm" name="id2655651"></a><pre class="programlisting">#define     g_return_if_reached()</pre>
<p>
Регистрирует критическое сообщение и завершает текущую функцию. 
Используется только в функциях которые не возвращают значений.
</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655668"></a><h3>
<a name="g-return-val-if-reached"></a>g_return_val_if_reached()</h3>
<a class="indexterm" name="id2655681"></a><pre class="programlisting">#define     g_return_val_if_reached(val)</pre>
<p>
Регистрирует критическое сообщение и возвращает <em class="parameter"><code>val</code></em>. 
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>val</code></em>&#160;:</span></td>
<td>значение возвращаемое из текущей функции.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655722"></a><h3>
<a name="g-assert"></a>g_assert()</h3>
<a class="indexterm" name="id2655734"></a><pre class="programlisting">#define     g_assert(expr)</pre>
<p>
Отладочный макрос для завершения приложения если выражение неправильно.
Если выражение неправильно (то есть логическое выражение не верно), регистрируется сообщение об ошибке и приложение закрывается.
</p>
<p>
Макрос можно отключить в завершающем релизе определив 
<span class="type">G_DISABLE_ASSERT</span> при компиляции приложения.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>expr</code></em>&#160;:</span></td>
<td>проверяемое выражение.
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655786"></a><h3>
<a name="g-assert-not-reached"></a>g_assert_not_reached()</h3>
<a class="indexterm" name="id2655799"></a><pre class="programlisting">#define     g_assert_not_reached()</pre>
<p>
Отладочный макрос для прекращения выполнения приложения при его достижении.
Если он достигнут, регистрируется сообщение об ошибке и приложение закрывается.
</p>
<p>
Макрос можно отключить при окончательной реализации с помощью определения 
<span class="type">G_DISABLE_ASSERT</span> при компиляции приложения.
</p>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2655831"></a><h3>
<a name="g-on-error-query"></a>g_on_error_query ()</h3>
<a class="indexterm" name="id2655844"></a><pre class="programlisting">void        g_on_error_query                (const <a href="glib-Basic-Types.html#gchar">gchar</a> *prg_name);</pre>
<p>
Подсказка ввода для пользователя <code class="computeroutput">[E]xit, [H]alt, показать [S]tack trace или [P]roceed</code>.
Эта функция только для использования при отладке приложения. Следующий пример демонстрирует как её можно использовать совместно с функцией <a href="glib-Message-Logging.html#g-log"><code class="function">g_log()</code></a>.
</p>
<div class="informalexample"><pre class="programlisting">
#include &lt;glib.h&gt;

static void 
log_handler (const gchar   *log_domain,
	     GLogLevelFlags log_level,
	     const gchar   *message,
	     gpointer       user_data)
{
  g_log_default_handler (log_domain, log_level, message, user_data);

  g_on_error_query (MY_PROGRAM_NAME);
}

int main (int argc, char *argv[])
{
  g_log_set_handler (MY_LOG_DOMAIN,
		     G_LOG_LEVEL_WARNING | 
                     G_LOG_LEVEL_ERROR | 
                     G_LOG_LEVEL_CRITICAL,
		     log_handler,
		     NULL);

 /* ... */  
</pre></div>
<p>
Если [E]xit выбран, приложение закрывается с помощью вызова <code class="function">_exit(0)</code>.
</p>
<p>
Если выбрано [H]alt, приложение входит в бесконечный цикл.
Бесконечный цикл можно остановить только уничтожив приложение,
или установив <span class="type">glib_on_error_halt</span> в <a href="glib-Standard-Macros.html#FALSE:CAPS"><code class="literal">FALSE</code></a> (возможно через отладчик).
</p>
<p>
Если выбрано [S]tack trace, вызывается <a href="glib-Warnings-and-Assertions.html#g-on-error-stack-trace"><code class="function">g_on_error_stack_trace()</code></a>. Это вызывает
<span><strong class="command">gdb</strong></span>, который присоединяется к текущему процессу и показывает распечатку стека (stack trace).
Подсказка ввода показывается снова.
</p>
<p>
Если выбрано [P]roceed, функция завершается возвратом.
</p>
<p>
Эта функция может вызвать разные действия на не-UNIX платформах.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>prg_name</code></em>&#160;:</span></td>
<td>имя программы, необходимо отладчику <span><strong class="command">gdb</strong></span> для опции распечатки стека ([S]tack trace option).
Если <em class="parameter"><code>prg_name</code></em> равно <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>, <a href="glib-Miscellaneous-Utility-Functions.html#g-get-prgname"><code class="function">g_get_prgname()</code></a> вызывается для получения имени 
программы (которая будет работать правильно если вызваны <code class="function">gdk_init()</code> 
или <code class="function">gtk_init()</code>).
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2656061"></a><h3>
<a name="g-on-error-stack-trace"></a>g_on_error_stack_trace ()</h3>
<a class="indexterm" name="id2656074"></a><pre class="programlisting">void        g_on_error_stack_trace          (const <a href="glib-Basic-Types.html#gchar">gchar</a> *prg_name);</pre>
<p>
Вызывает <span><strong class="command">gdb</strong></span>, который присоединяется к текущему процессу и показывает распечатку стека.
Вызывается функцией  <a href="glib-Warnings-and-Assertions.html#g-on-error-query"><code class="function">g_on_error_query()</code></a> когда выбрана опция [S]tack trace.
</p>
<p>
Эта функция может выполнять разные действия на не-UNIX платформах.
</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><span class="term"><em class="parameter"><code>prg_name</code></em>&#160;:</span></td>
<td>имя програмы, нужно отладчику <span><strong class="command">gdb</strong></span> для опции распечатки стека ([S]tack trace option).
Если <em class="parameter"><code>prg_name</code></em> равно <a href="glib-Standard-Macros.html#NULL:CAPS"><code class="literal">NULL</code></a>, <a href="glib-Miscellaneous-Utility-Functions.html#g-get-prgname"><code class="function">g_get_prgname()</code></a> вызывается для получения имени программы (которая будет правильно работать если вызваны <code class="function">gdk_init()</code> или <code class="function">gtk_init()</code>).
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" lang="en">
<a name="id2656198"></a><h3>
<a name="G-BREAKPOINT:CAPS"></a>G_BREAKPOINT()</h3>
<a class="indexterm" name="id2656211"></a><pre class="programlisting">#define     G_BREAKPOINT()</pre>
<p>
Вставляет контрольную точку в код (только на x86 архитектуре).
</p>
</div>
</div>
</div>
</body>
</html>
